/*! puredom.sync 05-01-2014 */
!function(a){"function"==typeof window.define&&window.define.amd?window.define(["puredom"],a):a(window.puredom)}(function(a){var b={VERSION:"1.1.0"};return a.addNodeSelectionPlugin("sync",function(){var b,c=new a.SyncNodeSelection(this),d=a.NodeSelection.prototype,e=a.SyncNodeSelection.prototype;for(b in d)d.hasOwnProperty(b)&&!e.hasOwnProperty(b)&&"function"==typeof d[b]&&(e[b]=e._wrapAsyncMethod(b));return c}),a.SyncNodeSelection=function(b){this._selection=a(b),this._asyncQueue=[]},a.extend(a.SyncNodeSelection.prototype,{async:function(){return this._addToQueue(this.dispose,null,this,!0),this._selection},sync:function(){return this},then:function(b){var c=a.toArray(arguments).slice(1);return this._addToQueue(function(){c.splice(0,0,this._selection),b.apply(this._selection,c),c=b=null,this.async()},null,this,!0),this},dispose:function(){return this._queueTimer&&clearTimeout(this._queueTimer),this._selection=this._asyncQueue=this._queueTimer=null,null},_addToQueue:function(b){arguments.length>1&&(b=a.toArray(arguments)),this._asyncQueue.push(b),this._processQueue()},_processQueue:function(){var b=this;this._queueTimer&&clearTimeout(this._queueTimer),this._asyncWaiting!==!0&&(this._queueTimer=setTimeout(function(){var c=b._asyncQueue&&b._asyncQueue.splice(0,1)[0],d=[],e=b,f=!1;this._queueTimer=null,c&&(a.isArray(c)&&(f=c[3]===!0,e=c[2]||e,d=d.concat(c[1]),c=c[0]),b._asyncWaiting=!0,c.apply(e,d),f&&(b._asyncWaiting=!1,b._processQueue())),b=null},1))},_asyncList:{wait:1,fadeIn:1,fadeOut:1,animate:3,css:2,on:1,_createAnimationObj:3,position:[2,"callback"]},_wrapAsyncMethod:function(b){var c=a.NodeSelection.prototype[b].asyncDefinition,d=!!c;return!d&&this._asyncList.hasOwnProperty(b)&&(d=!0,c=this._asyncList[b]),function(){var e,f,g,h,i=a.toArray(arguments);return d&&(e=this,g=function(){h&&h.apply&&h.apply(this,arguments),e._asyncWaiting=!1,e._processQueue(),e=h=null},a.isArray(c)?(f=i[c[0]]||{},h=f[c[1]],f[c[1]]=g,i[c[0]]=f):(h=i[c],i[c]=g),f=g=null),this._addToQueue(function(){this._selection[b].apply(this._selection,i),d||this._processQueue(),i=null}),this}}}),b});